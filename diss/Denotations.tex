\documentclass{report}

\input{header.tex}

\begin{document}
\section{Denotations of Types}
\subsection{Denotation of Type Environments}
Given a function $\deno{\_}$ mapping types to objects in the category $\C$, we can define the denotation of an $\ok{}$ type environment $\G$.
$$\deno{\nil} = \1$$
$$\deno{\gax} = (\deno{\G}\times\deno{A}) $$

For ease of notation, and since we normally only talk about one denotation function at a time, I shall typically drop the denotation notation when talking about the denotation of value types and type environments. Hence, $$\deno{\gax} = \G \times A$$

\subsection{Denotation of Computation Type}
Given a function $\deno{\_}$ mapping value types to objects in the category $\C$, we write the denotation of Computation types $\mea$ as so:

$$\deno{\mea} = \T{\e}{\deno{A}}$$

Since we can infer the denotation function, we can include it implicitly an drop the denotation sign.

$$\deno{\mea} = \tea$$

\subsection{Denotation of Function Types}
Given a function $\deno{\_}$ mapping types to objects in the category $\C$, we write the denotation of a function type $\lamtype{A}{\e}{B}$ as so:
$$\deno{\lamtype{A}{\e}{B}} = (\T{\e}{\deno{B}})^{\deno{A}}$$

Again, since we can infer the denotation function, Let us drop the notation.

$$\deno{\lamtype{A}{\e}{B}} = (\teb)^A$$



\section{Denotation of Terms}
Given the denotation of types and typing environments, we can now define denotations of well typed terms.

$$\deno{\gtyperelation{t}{\tau}}: \G \rightarrow \deno{\tau}$$

Denotations are defined recursively over the typing derivation of a term. Hence, they implicitly depend on the exact derivation used. Since, as proven in the chapter on the uniqueness of derivations, the denotations of all type derivations yielding the same type relation $\gtyperelation{t}{\tau}$ are equal, we need not refer to the derivation that yielded each denotation.

\subsection{Denotation of Value Terms}
\begin{itemize}
    \item $\treerule{Unit}{\ok{\G}}{\deno{\typerelation{\G}{\u}{\U}} = \deno{\u} \after \term{\G} : \G \rightarrow \deno{\U}}$
        
    \item $\treerule{Const}{\ok{\G}}{\deno{\typerelation{\G}{\const{A}}{A}} = \deno{\const{A}} \after \term{\G} : \G \rightarrow \deno{A}}$
         
    \item $\treerule{True}{\ok{\G}}{\deno{\typerelation{\G}{\t}{\B}} = \deno{\t} \after \term{\G} : \G \rightarrow \deno{\B}}$
        
    \item $\treerule{False}{\ok{\G}}{\deno{\typerelation{\G}{\f}{\B}} = \deno{\f} \after \term{\G} : \G \rightarrow \deno{\B}}$
        
    \item $\treerule{Var}{\ok{\G}}{\deno{\typerelation{\gax}{x}{A}} = \pp: \G \times A \rightarrow A}$
    \item $\treerule{Weaken}{f = \deno{\gtyperelation{x}{A}}: \G \rightarrow A}{\deno{\typerelation{\gby}{x}{A}} = f \after \p: \G \times B \rightarrow A}$
    \item $\treerule{Lambda}{f = \deno{\gax}{C}{\meb} : \G \times A \rightarrow \teb}{\deno{\typerelation{\G}{\lam{x}{A}{C}}{A \rightarrow \meb}} = \cur{f} : \G \rightarrow (\teb)^A}$
    
    \item $\treerule{Subtype}{f = \deno{\typerelation{\G}{v}{A}} : \G \rightarrow A\s\s g = \deno{A \subtype B}}{\deno{\typerelation{\G}{v}{B}} = g \after f : \G \rightarrow B}$
  
\end{itemize}
\subsection{Denotation of Computation Terms}
\begin{itemize}     
    \item $\treerule{Return}{f = \deno{\typerelation{\G}{v}{A}}}{\deno{\typerelation{\G}{\return{v}}{\moa}} = \point{A} \after f}$
        
 
    \item $\treerule{If}{f = \deno{\typerelation{\G}{v}{\B}}\s\s g = \deno{\typerelation{\G}{C_1}{\mea}}\s\s h = \deno{\typerelation{\G}{C_2}{\mea}}}{\deno{{\typerelation{\G}{\ifthenelse{\e}{A}{v}{C_1}{C_2}}{\mea}}} = \ifnt{\meb} \after \pr{f}{\pr{g}{h}} : \G \rightarrow \tea}$
        
    \item $\treerule{Bind}{f = \deno{\typerelation{\G}{C_1}{\M{\e_1}{A}} : \G \rightarrow \T{\e_1}{A}\s\s g = \deno{\typerelation{\gax}{C_2}{\M{\e_2}{B}}}}: \G \times A \rightarrow \T{\e_2}{B}}{\deno{\typerelation{\G}{\doin{x}{C_1}{C_2}}{\M{\e_1 \dot \e_2}}} = \bind{\e_1}{\e_2}{B} \after \T{\e_1}{g} \after \tstrength{\G}{A}{\e_1} \after \pr{\Id{\G}}{f}: \G \rightarrow \T{\e_1 \dot \e_2}{B}}$ 
    \item  $\treerule{Subeffect}{f = \deno{\typerelation{\G}{c}{\M{\e_1}{A}}}: \G \rightarrow \T{\e_1}{A} \s\s g = \deno{A \subtype B}\s\s h = \dse{\e_1}{\e_2}}{\deno{\typerelation{\G}{C}{\M{\e_2}{B}}} = h_B \after \T{\e_1}{g} \after f}$
    \item $\treerule{Apply}{f = \deno{\gtyperelation{v_1}{\lamtype{A}{\e}B}}: \G \rightarrow (\teb)^{A} \s\s g=\deno{\gtyperelation{v_2}{A}}: \G \rightarrow A}{\deno{\gtyperelation{\apply{v_1}{v_2}}{\meb}}: \G \rightarrow \teb}$
\end{itemize}
\end{document}