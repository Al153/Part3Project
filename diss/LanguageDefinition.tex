\documentclass{report}

\input{header.tex}


\begin{document}
\section{Terms}
    \subsection{Value Terms}

    \begin{equation}
        \begin{split}
            v \gens & x \\
            & \mid \lam{x}{A}{C} \\
            & \mid \const{A} \\
            & \mid \u \\
            & \mid \t \mid \f \\
        \end{split}
    \end{equation}

    \subsection{Computation Terms}
        \begin{equation}
            \begin{split}
                C \gens & \ifthenelse{\e}{A}{v}{C_1}{C_2} \\
                        & \mid \apply{v_1}{v_2} \\
                        & \mid \doin{x}{C_1}{C_2} \\
                        & \mid \return{v}
            \end{split}
        \end{equation}
 
\section{Type System}
    \subsection{Types}
        \paragraph{Ground Types}
            There exists a set $\ground$ of ground types, including \U, \B
        \paragraph{Value Types}
        $$ A, B, C \gens \ground \mid \lamtype{A}{\e}{B} $$
        \paragraph{Computation Types}
        Computation types are of the form $\mea$

    \subsection{Subtyping}
        There exists a subtyping preorder relation $\subtype_{\ground}$ over ground types that is:
        \begin{itemize}
            \item $\treerule{Reflexive}{}{A \subtype_{\ground} A}$
            \item $\treerule{Transitive}{A \subtype_{\ground} B \s \s B \subtype_{\ground} C}{A \subtype_{\ground} C}$
        \end{itemize}

        We extend this relation with the function subtyping rule to yield the full subtyping relation $\subtype$

        \begin{itemize}
            \item $\treerule{ground}{A \subtype_{\ground} B}{A \subtype B}$
            \item $\treerule{Fn}{A \subtype A' \s\s B' \subtype B \s \s \e \subeffect \e'}{\lamtype{A'}{\e'}{B'} \subtype \lamtype{A}{\e}{B}}$
        \end{itemize}
    \subsection{Type Environments}
    An environment, $G \gens \nil \mid \gax$ 
    \paragraph{Domain Function}
    \begin{itemize}
        \item $\dom{\nil} = \emptyset$
        \item $\dom{\gax} =  \dom{\G}  \cup \left\{x \right\}$
    \end{itemize}
    \paragraph{$\ok{}$ Predicate}
    \begin{itemize}
        \item $\treerule{Atom}{}{\ok{\nil}}$
        \item $\treerule{Var}{\ok{\G} \s\s x\notin \dom{\G}}{\ok{\gax}}$
    \end{itemize}



    \subsection{Type Rules}
    \paragraph{Value Typing Rules}
    \begin{itemize}
        \item $\truleconst$
        \item $\truleunit$
        \item $\truletrue$
        \item $\trulefalse$
        \item $\treerule{Var}{}{\typerelation{\gax}{X}{A}}$
        \item $\condtreerule{Weaken}{\typerelation{\G}{x}{A}}{\typerelation{\gby}{X}{A}}{x \neq y}$
        \item $\treerule{Fn}{\typerelation{\gax}{C}{\meb}}{\typerelation{\G}{\lam{x}{A}{C}}{\lamtype{A}{\e}{B}}}$
        \item $\treerule{Sub}{\typerelation{\G}{v}{A}\s\s A \subtype B}{\typerelation{\G}{v}{B}}$
    \end{itemize}
    \paragraph{Computation typing rules}
    \begin{itemize}
        \item $\treerule{Return}{\typerelation{\G}{v}{A}}{\typerelation{\G}{\return{v}}{\M{\1}{A}}}$
        \item $\treerule{Apply}{\typerelation{\G}{v_1}{\lamtype{A}{\e}{B}}\s\s\typerelation{\G}{v_2}{A}}{\typerelation{\G}{\apply{v_1}{v_2}}{\meb}}$
        \item $\treerule{if}{\typerelation{\G}{v}{\B} \s\s \typerelation{\G}{C_1}{\mea}\s\s\typerelation{\G}{C_2}{\mea}}{\typerelation{\G}{\ifthenelse{\e}{A}{V}{C_1}{C_2}}{\mea}}$
        \item $\treerule{Do}{\typerelation{\G}{C_1}{\M{\e_1}{A}} \s\s \typerelation{\gax}{C_2}{\M{\e_2}{B}}}{\typerelation{\G}{\doin{x}{C_1}{C_2}}{\M{\e_1 \dot \e_2}{B}}}$
        \item $\treerule{Subeffect}{\typerelation{\G}{C}{\M{\e_1}{A}}\s\s A \subtype B \s\s \e_1 \subeffect \e_2}{\typerelation{\G}{C}{\M{e_2}{B}}}$
    \end{itemize}
\end{document}
